<!DOCTYPE html>
<!--
██   ██ ███████ ██      ██       ██████  ██ 
██   ██ ██      ██      ██      ██    ██ ██ 
███████ █████   ██      ██      ██    ██ ██ 
██   ██ ██      ██      ██      ██    ██    
██   ██ ███████ ███████ ███████  ██████  ██ 
-->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Day 2 of Advent of Code 2025 in Charly</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Leonard Schütz">
    <meta name="description" content="Day 2 of Advent of Code 2025 in
Charly">
    <meta name="keywords" content="leonard schütz, programming, compilers, ">
    <meta name="language" content="English">
    <meta name="contact" content="hello@leonard.swiss">
    <meta name="date" content="Mon, 02 Dec 2025 13:15:00 +0100">

    <meta property="og:url" content="https://leonard.swiss/">
    <meta property="og:title" content="Day 2 of Advent of Code 2025 in Charly">
    <meta property="og:description" content="Day 2 of Advent of Code
2025 in Charly">
    <meta property="og:site_name" content="Leonard Schütz">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_US">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@leni4838">
    <meta name="twitter:title" content="Day 2 of Advent of Code 2025 in Charly">
    <meta name="twitter:description" content="Day 2 of Advent of Code
2025 in Charly">

    <link rel='shortcut icon' type='image/x-icon' href='/favicon.ico'/>
    <link rel="stylesheet" type="text/css" href="/resources/css/style.css"/>
    <link rel="alternate" type="application/rss+xml" title="Blog" href="/feed.xml" />
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">

          <style type="text/css">
        code {
          white-space: pre;
        }
      </style>
      <style type="text/css">
        html { -webkit-text-size-adjust: 100%; }
        pre > code.sourceCode { white-space: pre; position: relative; }
        pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
        pre > code.sourceCode > span:empty { height: 1.2em; }
        .sourceCode { overflow: visible; }
        code.sourceCode > span { color: inherit; text-decoration: inherit; }
        div.sourceCode { margin: 1em 0; }
        pre.sourceCode { margin: 0; }
        @media screen {
        div.sourceCode { overflow: auto; }
        }
        @media print {
        pre > code.sourceCode { white-space: pre-wrap; }
        pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
        }
        pre.numberSource code
          { counter-reset: source-line 0; }
        pre.numberSource code > span
          { position: relative; left: -4em; counter-increment: source-line; }
        pre.numberSource code > span > a:first-child::before
          { content: counter(source-line);
            position: relative; left: -1em; text-align: right; vertical-align: baseline;
            border: none; display: inline-block;
            -webkit-touch-callout: none; -webkit-user-select: none;
            -khtml-user-select: none; -moz-user-select: none;
            -ms-user-select: none; user-select: none;
            padding: 0 4px; width: 4em;
            color: #aaaaaa;
          }
        pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
        div.sourceCode
          {  background-color: #f8f8f8; }
        @media screen {
        pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
        }
        code span.al { color: #ef2929; } /* Alert */
        code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
        code span.at { color: #204a87; } /* Attribute */
        code span.bn { color: #0000cf; } /* BaseN */
        code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
        code span.ch { color: #4e9a06; } /* Char */
        code span.cn { color: #8f5902; } /* Constant */
        code span.co { color: #8f5902; font-style: italic; } /* Comment */
        code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
        code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
        code span.dt { color: #204a87; } /* DataType */
        code span.dv { color: #0000cf; } /* DecVal */
        code span.er { color: #a40000; font-weight: bold; } /* Error */
        code span.ex { } /* Extension */
        code span.fl { color: #0000cf; } /* Float */
        code span.fu { color: #204a87; font-weight: bold; } /* Function */
        code span.im { } /* Import */
        code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
        code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
        code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
        code span.ot { color: #8f5902; } /* Other */
        code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
        code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
        code span.ss { color: #4e9a06; } /* SpecialString */
        code span.st { color: #4e9a06; } /* String */
        code span.va { color: #000000; } /* Variable */
        code span.vs { color: #4e9a06; } /* VerbatimString */
        code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
      </style>
            </head>
  <body>
    <div id="content">
      <header>
        <div id="name-container">
          <a href="/">leonard schütz</a>
        </div>
        <nav>
          <a href="/about">about</a>
          <a href="/blog/">blog</a>
        </nav>
      </header>
      <main class="blog-article">
<h1 id="advent-of-code-2025-in-charly">Advent of Code 2025 in
Charly</h1>
<h2 id="day-2">Day 2</h2>
<ul class="incremental">
<li><a href="../">Back to the main article</a></li>
<li><a href="../day1">Previous day</a> - <a href="../day3">Next
day</a></li>
</ul>
<p>Today’s task involved determining the set of invalid IDs from a list
of ID-ranges. An ID was invalid if its string representation consisted
of two repeated substrings of equal length.</p>
<p>E.g. <code>55</code>, <code>123123</code>, <code>827827</code> are
all invalid IDs.</p>
<p>The second part modified the challenge to instead define an invalid
ID as a repetition of <code>N</code> equally-sized substrings.</p>
<p>I solved the problem by looping over each ID in the provided ranges,
determining the sets of potential substrings that could form the entire
ID and then checking if that ID actually consists only of <code>N</code>
repetitions of that substring.</p>
<p>Charly does support concurrent and parallel execution of code, which
I attempted at first, but the overhead of that implementation almost
doubled the execution time, so I left it at a single-threaded
implementation.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/local/bin/charly</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ARGV<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> <span class="dv">2</span> {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Missing filepath&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exit</span>(<span class="dv">1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> input_path <span class="op">=</span> ARGV[<span class="dv">1</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> input <span class="op">=</span> <span class="fu">readfile</span>(input_path)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> ranges <span class="op">=</span> input</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;,&quot;</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>(<span class="op">-&gt;</span>(entry) {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> (first<span class="op">,</span> last) <span class="op">=</span> entry<span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;-&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        (first<span class="op">.</span><span class="fu">to_number</span>()<span class="op">,</span> last<span class="op">.</span><span class="fu">to_number</span>())</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> allIds <span class="op">=</span> []</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ranges<span class="op">.</span><span class="fu">each</span>(<span class="op">-&gt;</span>(range) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> (first<span class="op">,</span> last) <span class="op">=</span> range</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    first<span class="op">.</span><span class="fu">upTo</span>(last<span class="op">,</span> <span class="op">-&gt;</span>(idx) {</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        allIds<span class="op">.</span><span class="fu">push</span>(idx)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>func <span class="fu">checkIsInvalid</span>(entry) {</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> length <span class="op">=</span> entry<span class="op">.</span><span class="at">length</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> possibleParts <span class="op">=</span> <span class="fl">1.</span><span class="fu">collectUpTo</span>(length <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="op">-&gt;</span>(partLength) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        entry<span class="op">.</span><span class="fu">substring</span>(<span class="dv">0</span><span class="op">,</span> partLength)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">filter</span>(<span class="op">-&gt;</span>(part) {</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            <span class="co">// filter out parts that cannot possibly form the entire pattern</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            entry<span class="op">.</span><span class="at">length</span> <span class="op">%</span> part<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    possibleParts<span class="op">.</span><span class="fu">filter</span>(<span class="op">-&gt;</span>(part) {</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> multiplier <span class="op">=</span> entry<span class="op">.</span><span class="at">length</span> <span class="op">/</span> part<span class="op">.</span><span class="at">length</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> check <span class="op">=</span> part <span class="op">*</span> multiplier</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        check <span class="op">==</span> entry</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    })<span class="op">.</span><span class="fu">notEmpty</span>()</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> invalidIds <span class="op">=</span> allIds</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>(<span class="op">-&gt;</span>(id) <span class="st">&quot;{id}&quot;</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(<span class="op">-&gt;</span>(entry) {</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">checkIsInvalid</span>(entry)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>(<span class="op">-&gt;</span>(entry) entry<span class="op">.</span><span class="fu">to_number</span>())</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> totalSum <span class="op">=</span> invalidIds<span class="op">.</span><span class="fu">reduce</span>(<span class="dv">0</span><span class="op">,</span> <span class="op">-&gt;</span>(p<span class="op">,</span> c) p <span class="op">+</span> c)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totalSum)</span></code></pre></div>
<h2 id="changes-to-the-stdlib-vm">Changes to the stdlib / VM</h2>
<p>The only additions to the standard library today were the
<code>Int::upTo</code> and <code>List::notEmpty</code> methods. You can
see the implementations of those methods below:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>func <span class="fu">upTo</span>(other<span class="op">,</span> callback) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    assert other <span class="kw">instanceof</span> <span class="bu">Number</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> other <span class="op">&lt;</span> self {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> result <span class="op">=</span> []</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> i <span class="op">=</span> self</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&lt;=</span> other {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> r <span class="op">=</span> <span class="fu">callback</span>(i)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        result<span class="op">.</span><span class="fu">push</span>(r)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    result</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>func notEmpty <span class="op">=</span> @length <span class="op">&gt;</span> <span class="dv">0</span></span></code></pre></div>
<p>The individual commits can be found here:</p>
<ul class="incremental">
<li><a
href="https://github.com/KCreate/charly-vm/commit/6f940e22b405433ba47063359ecf0f07307fdbfc"><code>6f940e2</code></a>
<code>Added Int::upTo</code></li>
<li><a
href="https://github.com/KCreate/charly-vm/commit/bc4080d66c110a5cc463b759930aa470e72e60fe"><code>bc4080d</code></a>
<code>Added List::notEmpty</code></li>
</ul>
<h2 id="late-night-addendum">Late-night Addendum</h2>
<blockquote>
<p>Charly does support concurrent and parallel execution of code, which
I attempted at first, but the overhead of that implementation almost
doubled the execution time, so I left it at a single-threaded
implementation.</p>
</blockquote>
<p>This didn’t quite sit right with me, so I investigated a bit. It
turned out that that the runtime was heavily bottlenecked by mutex
locks/unlocks, caused by the VM accessing the global list of object
shape instances and reading to / writing from global variables.</p>
<p>I’ve removed locks where possible, added a per-processor shape
caching layer and also replaced the default
<code>std::unordered_map</code> hashtable used for global variables with
<a
href="https://github.com/greg7mdp/parallel-hashmap/tree/master">greg7mdp/parallel-hashmap</a>.</p>
<p>These changes, alongside some minor tweaks to the implementation of
the puzzle solving code, brought down execution time by around
<strong><code>60%</code></strong>. Multi-threading the execution also
resulted in a measurable performance improvement, altough not as much as
I would’ve liked.</p>
<p>Below you can see the updated implementation of today’s puzzle:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/local/bin/charly</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ARGV<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> <span class="dv">2</span> {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Missing filepath&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exit</span>(<span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> input_path <span class="op">=</span> ARGV[<span class="dv">1</span>]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> input <span class="op">=</span> <span class="fu">readfile</span>(input_path)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> ranges <span class="op">=</span> input</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;,&quot;</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>(<span class="op">-&gt;</span>(entry) {</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> (first<span class="op">,</span> last) <span class="op">=</span> entry<span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;-&quot;</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        (first<span class="op">.</span><span class="fu">to_number</span>()<span class="op">,</span> last<span class="op">.</span><span class="fu">to_number</span>())</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> invalidIdsPerRange <span class="op">=</span> ranges</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">parallelMap</span>(<span class="op">-&gt;</span>(range) {</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> (first<span class="op">,</span> last) <span class="op">=</span> range</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> invalidIds <span class="op">=</span> []</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        first<span class="op">.</span><span class="fu">upTo</span>(last<span class="op">,</span> <span class="op">-&gt;</span>(i) {</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> entry <span class="op">=</span> <span class="st">&quot;{i}&quot;</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> length <span class="op">=</span> entry<span class="op">.</span><span class="at">length</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> parts <span class="op">=</span> <span class="fl">1.</span><span class="fu">collectUpTo</span>(length <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="op">-&gt;</span>(partlength) entry<span class="op">.</span><span class="fu">substring</span>(<span class="dv">0</span><span class="op">,</span> partlength))</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> possibleParts <span class="op">=</span> parts<span class="op">.</span><span class="fu">filter</span>(<span class="op">-&gt;</span>(part) {</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                entry<span class="op">.</span><span class="at">length</span> <span class="op">%</span> part<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> isInvalid <span class="op">=</span> possibleParts<span class="op">.</span><span class="fu">any</span>(<span class="op">-&gt;</span>(part) {</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> multiplier <span class="op">=</span> entry<span class="op">.</span><span class="at">length</span> <span class="op">/</span> part<span class="op">.</span><span class="at">length</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> check <span class="op">=</span> part <span class="op">*</span> multiplier</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                check <span class="op">==</span> entry</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> isInvalid {</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                invalidIds<span class="op">.</span><span class="fu">push</span>(i)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>        invalidIds</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">flatten</span>()</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> totalSum <span class="op">=</span> invalidIdsPerRange<span class="op">.</span><span class="fu">reduce</span>(<span class="dv">0</span><span class="op">,</span> <span class="op">-&gt;</span>(p<span class="op">,</span> c) p <span class="op">+</span> c)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totalSum)</span></code></pre></div>
<p>And all the commits that made up tonights late-night hacking
session:</p>
<ul class="incremental">
<li><a
href="https://github.com/KCreate/charly-vm/commit/29bc22a2d413a3b1588908493bd2a8c38532562f"><code>29bc22a</code></a>
<code>Implemented per-proc shape lookup cache</code></li>
<li><a
href="https://github.com/KCreate/charly-vm/commit/d752e6eb4b3f2ada7ef722db4b4716d90071d64c"><code>d752e6e</code></a>
<code>Use parallel_hashmap for global variables</code></li>
<li><a
href="https://github.com/KCreate/charly-vm/commit/5c2c36ad87b3416e0a3dc62ff90feb31045a3259"><code>5c2c36a</code></a>
<code>Add List::any</code></li>
<li><a
href="https://github.com/KCreate/charly-vm/commit/c7ffd2eff03493f574e56b05aef34925e543dc72"><code>c7ffd2e</code></a>
<code>Add List::flatten</code></li>
<li><a
href="https://github.com/KCreate/charly-vm/commit/3a061014221c7c19d415f119567a5bf03998b61b"><code>3a06101</code></a>
<code>Add List::parallelMap and Int::parallelMap</code></li>
<li><a
href="https://github.com/KCreate/charly-vm/commit/387dea62a9f8954a9083f52ed162a76e3d874b6c"><code>387dea6</code></a>
<code>Add Int::parallelTimes</code></li>
<li><a
href="https://github.com/KCreate/charly-vm/commit/20590534828981282ad1731455fd429cdfecc092"><code>2059053</code></a>
<code>Add Int::collectUpTo</code></li>
</ul>
<h2 id="even-later-late-night-addendum">Even later late-night
Addendum</h2>
<p>I had to revert some previous changes, because my previous commits
caused some crazy unpredictable segfaults to happen. While I don’t
believe the locking I added back in again truly solved the issue,
they’re merely masking it, I do kind of need a semi-working language to
solve the upcoming puzzles.</p>
<p>I shall revisit this at a later time.</p>
<ul class="incremental">
<li><a
href="https://github.com/KCreate/charly-vm/commit/908f02c7bfd4add1cf9cc9e16cbcb9d0603a4cc5"><code>908f02c</code></a>
<code>Added locks around builtin class logic again</code></li>
</ul>
<h2 id="links">Links</h2>
<ul class="incremental">
<li><a href="https://github.com/KCreate/charly-vm">Charly Programming
Language</a></li>
<li><a
href="https://github.com/KCreate/advent-of-code-2025-charly/blob/main/days/day2/day2.ch">Source
code for today’s challenge</a></li>
<li><a
href="https://github.com/KCreate/advent-of-code-2025-charly/blob/main/days/day2/day2-parallel.ch">Source
code for today’s challenge (parallel)</a></li>
</ul>
      </main>
      <hr/>
      <footer>
        <div id="social-links">
          <a href="https://github.com/KCreate" target="_blank">
            <img height="20" width="20" src="/resources/github.svg" alt="GitHub Link"/>
          </a>
          <a href="https://linkedin.com/in/leonardschuetz" target="_blank">
            <img height="20" width="20" src="/resources/linkedin.svg" alt="LinkedIn Link"/>
          </a>
          <a href="mailto:hello@leonard.swiss?subject=Hello%20Leonard!">
            <img height="20" width="20" src="/resources/mail.svg" alt="Email Link"/>
          </a>
          <a href="/rss.xml" target="_blank">
            <img height="20" width="20" src="/resources/rss.svg" alt="RSS Link"/>
          </a>
        </div>
        <div id="open-source-notice">
          <span>this blog is <a href="https://github.com/KCreate/leonardschuetz.ch" target="_blank">open-source</a></span>
        </div>
      </footer>
      <span id="copyright">Copyright © 2024 - 2025 Leonard Schütz | <a href="/attributions">Attributions</a></span>
      <span id="copyright">This post was written by a human and reviewed and proof-read by LLMs</span>
    </div>
  </body>
  <script src="/script.js" async></script>
</html>
